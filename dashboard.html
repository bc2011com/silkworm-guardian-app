<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏≠‡∏≤‡∏£‡∏±‡∏Å‡∏Ç‡∏≤‡∏£‡∏±‡∏á‡πÑ‡∏´‡∏°‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞ ‚Äì Dashboard</title>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Sarabun', Arial, sans-serif;
      background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%);
      min-height: 100vh;
      font-size: 22px;
      line-height: 1.6;
    }

    .container {
      max-width: 450px;
      margin: 0 auto;
      background: white;
      min-height: 100vh;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      position: relative;
      padding-bottom: 90px; /* ‡∏Å‡∏±‡∏ô bottom nav ‡∏ö‡∏±‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ */
    }

    .header {
      background: linear-gradient(135deg, #2e7d32 0%, #4caf50 100%);
      color: white;
      padding: 25px 20px;
      text-align: center;
      position: relative;
    }

    .header h1 {
      font-size: 28px;
      font-weight: bold;
      margin-bottom: 10px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }

    .voice-btn {
      position: absolute;
      right: 20px;
      top: 55%;
      transform: translateY(-50%);
      background: #ff6b35;
      border: none;
      border-radius: 50%;
      width: 70px;
      height: 70px;
      color: white;
      font-size: 30px;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
      transition: all 0.3s ease;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%   { transform: translateY(-50%) scale(1); }
      50%  { transform: translateY(-50%) scale(1.05); }
      100% { transform: translateY(-50%) scale(1); }
    }

    .voice-btn:hover {
      background: #e55a2b;
      transform: translateY(-50%) scale(1.1);
    }

    .status-bar {
      background: #fff3e0;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 2px solid #ffcc02;
    }

    .current-stage {
      font-size: 20px;
      font-weight: bold;
      color: #e65100;
    }

    .weather-info {
      font-size: 18px;
      color: #666;
    }

    .main-content {
      padding: 25px 20px;
    }

    .alert-section {
      background: #ffebee;
      border-left: 6px solid #f44336;
      padding: 20px;
      margin-bottom: 25px;
      border-radius: 8px;
      display: none;
    }

    .alert-section.show {
      display: block;
    }

    .alert-title {
      font-size: 22px;
      font-weight: bold;
      color: #c62828;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
    }

    .alert-icon {
      font-size: 30px;
      margin-right: 10px;
    }

    .alert-message {
      font-size: 20px;
      color: #666;
      line-height: 1.5;
    }

    .function-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 25px;
    }

    .function-card {
      background: white;
      border: 3px solid #e0e0e0;
      border-radius: 15px;
      padding: 25px 15px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      min-height: 140px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .function-card:hover {
      border-color: #4caf50;
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(76, 175, 80, 0.2);
    }

    .function-card.priority-high {
      border-color: #f44336;
      background: #ffebee;
    }

    .function-card.priority-medium {
      border-color: #ff9800;
      background: #fff3e0;
    }

    .function-icon {
      font-size: 40px;
      margin-bottom: 10px;
      display: block;
    }

    .function-title {
      font-size: 18px;
      font-weight: bold;
      color: #333;
      line-height: 1.3;
    }

    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      max-width: 450px;
      background: white;
      border-top: 3px solid #4caf50;
      display: flex;
      justify-content: space-around;
      padding: 15px 0;
      box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.1);
      z-index: 100;
    }

    .nav-item {
      text-align: center;
      cursor: pointer;
      padding: 10px;
      border-radius: 10px;
      transition: all 0.3s ease;
      flex: 1;
    }

    .nav-item:hover {
      background: #e8f5e8;
    }

    .nav-item.active {
      background: #4caf50;
      color: white;
    }

    .nav-icon {
      font-size: 30px;
      display: block;
      margin-bottom: 5px;
    }

    .nav-text {
      font-size: 16px;
      font-weight: bold;
    }

    .emergency-btn {
      position: fixed;
      bottom: 120px;
      right: 20px;
      background: #d32f2f;
      color: white;
      border: none;
      border-radius: 50%;
      width: 80px;
      height: 80px;
      font-size: 35px;
      cursor: pointer;
      box-shadow: 0 6px 20px rgba(211, 47, 47, 0.4);
      z-index: 101;
      animation: emergency-pulse 3s infinite;
    }

    @keyframes emergency-pulse {
      0%   { transform: scale(1); }
      50%  { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    .quick-actions {
      display: flex;
      gap: 15px;
      margin: 25px 0;
    }

    .quick-btn {
      flex: 1;
      background: #4caf50;
      color: white;
      border: none;
      border-radius: 10px;
      padding: 20px 10px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .quick-btn:hover {
      background: #388e3c;
      transform: translateY(-2px);
    }

    .quick-btn.camera {
      background: #2196f3;
    }
    .quick-btn.camera:hover {
      background: #1976d2;
    }

    .voice-commands {
      background: #e3f2fd;
      border-radius: 10px;
      padding: 20px;
      margin-top: 20px;
      border-left: 4px solid #2196f3;
    }

    .voice-commands h3 {
      font-size: 20px;
      color: #1565c0;
      margin-bottom: 15px;
    }

    .voice-commands ul {
      list-style: none;
      font-size: 16px;
      color: #666;
    }

    .voice-commands li {
      margin-bottom: 8px;
      padding-left: 20px;
      position: relative;
    }

    .voice-commands li::before {
      content: "üé§";
      position: absolute;
      left: 0;
    }

    /* Page Styles */
    .page { display: none; }
    .page.active { display: block; }

    .sub-header {
      background: #2196f3;
      color: white;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .back-btn {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      color: white;
      font-size: 20px;
      cursor: pointer;
    }

    .page-title {
      font-size: 22px;
      font-weight: bold;
    }

    .form-section {
      background: white;
      border: 2px solid #e0e0e0;
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .section-title {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 15px;
      color: #333;
    }

    .input-field {
      width: 100%;
      padding: 12px 15px;
      font-size: 18px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      margin-bottom: 15px;
    }

    .action-btn {
      background: #4caf50;
      color: white;
      border: none;
      border-radius: 10px;
      padding: 15px 25px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .action-btn:hover {
      background: #388e3c;
      transform: translateY(-2px);
    }

    @media (max-width: 480px) {
      .container { max-width: 100%; }
      .function-grid { grid-template-columns: 1fr; }
    }

    /* ==== ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏´‡∏ô‡πâ‡∏≤ ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï & ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ ==== */
    .report-main-card {
      max-width: 960px;
      margin: 12px auto 110px;
      padding: 18px 20px 22px;
      background: #ffffff;
      border-radius: 18px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      font-size: 16px;
    }

    .report-title {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .report-subtitle {
      font-size: 14px;
      color: #555;
      margin-bottom: 12px;
    }

    .report-block {
      margin-top: 14px;
      padding-top: 10px;
      border-top: 1px solid #e5e5e5;
    }

    .report-block h3 {
      font-size: 18px;
      margin-bottom: 6px;
    }

    .report-block ul {
      padding-left: 18px;
      margin: 0;
    }

    .report-block li { margin-bottom: 2px; }

    .report-grid-2 {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }

    .report-grid-2 > div { flex: 1 1 220px; }

    .report-table-header {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .report-filters {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .report-filters select {
      padding: 4px 6px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 13px;
    }

    .btn-outline,
    .btn-filled {
      padding: 5px 10px;
      border-radius: 999px;
      font-size: 13px;
      border: 1px solid #43a047;
      cursor: pointer;
    }

    .btn-outline {
      background: #ffffff;
      color: #388e3c;
    }

    .btn-filled {
      background: #43a047;
      color: #ffffff;
    }

    .report-table-wrapper {
      width: 100%;
      overflow-x: auto;
    }

    .report-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }

    .report-table th,
    .report-table td {
      padding: 6px 8px;
      border-bottom: 1px solid #e0e0e0;
      text-align: left;
    }

    .report-table thead th {
      background: #f5f5f5;
      font-weight: 600;
    }

    .chart-placeholder {
      margin-top: 8px;
      padding: 12px 10px 4px;
      border-radius: 14px;
      border: 1px dashed #90caf9;
      background: #e3f2fd;
      text-align: center;
      font-size: 14px;
      color: #1976d2;
    }

    .chart-placeholder canvas {
      width: 100%;
      height: 220px;
      max-height: 260px;
    }

    .report-note {
      font-size: 13px;
      color: #666;
    }

    @media (max-width: 600px) {
      .report-main-card {
        margin: 8px 8px 110px;
        padding: 14px 12px 18px;
        font-size: 15px;
      }
      .report-title { font-size: 20px; }
      .report-table { font-size: 13px; }
    }

    /* ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô */
    .setting-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
    }
    .setting-label {
      font-size: 16px;
      color: #333;
      max-width: 70%;
    }
    .setting-note {
      font-size: 13px;
      color: #666;
      margin-top: 6px;
    }
    .switch {
      position: relative;
      display: inline-block;
      width: 46px;
      height: 24px;
    }
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: 0.3s;
      border-radius: 24px;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: 0.3s;
      border-radius: 50%;
    }
    .switch input:checked + .slider {
      background-color: #4caf50;
    }
    .switch input:checked + .slider:before {
      transform: translateX(22px);
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å -->
    <div class="page active" id="homePage">
      <div class="header">
        <h1>üêõ ‡∏≠‡∏≤‡∏£‡∏±‡∏Å‡∏Ç‡∏≤‡∏£‡∏±‡∏á‡πÑ‡∏´‡∏°‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞</h1>
        <div style="font-size: 18px;">‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡πÑ‡∏ó‡∏¢</div>
        <button class="voice-btn" onclick="startVoiceCommand()" title="‡∏Å‡∏î‡∏û‡∏π‡∏î‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô">
          üé§
        </button>
      </div>

      <div class="status-bar">
        <div class="current-stage" id="currentStageText">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 15 ‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà 3</div>
        <div class="weather-info">üå°Ô∏è 28¬∞C üíß 75%</div>
      </div>

      <div class="alert-section" id="alertSection">
        <div class="alert-title">
          <span class="alert-icon">‚ö†Ô∏è</span>
          ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç!
        </div>
        <div class="alert-message" id="alertMessage">
          üïê ‡πÄ‡∏ß‡∏•‡∏≤ 14:00 ‡∏ô. - ‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà 3<br />
          üå°Ô∏è ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏π‡∏á ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡∏û‡∏±‡∏î‡∏•‡∏°‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô
        </div>
      </div>

      <div class="quick-actions">
        <button class="quick-btn camera" onclick="takePhoto()">üì∑ ‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û</button>
        <button class="quick-btn" onclick="callFamily()">üìû ‡πÇ‡∏ó‡∏£‡∏•‡∏π‡∏Å‡∏´‡∏•‡∏≤‡∏ô</button>
      </div>

      <div class="main-content">
        <div class="function-grid">
          <div class="function-card priority-high" onclick="showPage('feeding')">
            <span class="function-icon">üçÉ</span>
            <div class="function-title">‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£<br/>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>
          </div>

          <div class="function-card priority-medium" onclick="showPage('temperature')">
            <span class="function-icon">üå°Ô∏è</span>
            <div class="function-title">‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥<br/>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô</div>
          </div>

          <div class="function-card" onclick="showPage('cleaning')">
            <span class="function-icon">üßπ</span>
            <div class="function-title">‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î<br/>‡πÇ‡∏£‡∏á‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</div>
          </div>

          <div class="function-card" onclick="showPage('waste')">
            <span class="function-icon">üóëÔ∏è</span>
            <div class="function-title">‡∏ñ‡πà‡∏≤‡∏¢‡∏°‡∏π‡∏•<br/>‡∏Ç‡∏¢‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</div>
          </div>

          <div class="function-card" onclick="showPage('disease')">
            <span class="function-icon">ü¶†</span>
            <div class="function-title">‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á<br/>‡πÇ‡∏£‡∏Ñ‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°</div>
          </div>

          <div class="function-card" onclick="showPage('planning')">
            <span class="function-icon">üìã</span>
            <div class="function-title">‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô<br/>‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</div>
          </div>

          <div class="function-card" onclick="showPage('recording')">
            <span class="function-icon">üìä</span>
            <div class="function-title">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å<br/>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
          </div>

          <div class="function-card" onclick="showPage('report')">
            <span class="function-icon">üìã</span>
            <div class="function-title">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô<br/>‡πÇ‡∏£‡∏Ñ</div>
          </div>
        </div>

        <div class="voice-commands">
          <h3>üé§ ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ</h3>
          <ul>
            <li>"‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°" - ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£</li>
            <li>"‡∏ï‡∏£‡∏ß‡∏à‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥" - ‡∏î‡∏π‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô</li>
            <li>"‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û" - ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ</li>
            <li>"‡πÇ‡∏ó‡∏£‡∏•‡∏π‡∏Å‡∏´‡∏•‡∏≤‡∏ô" - ‡πÇ‡∏ó‡∏£‡∏Ç‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠</li>
            <li>"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•" - ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</li>
            <li>"‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥" - ‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</li>
            <li>"‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤" - ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£ -->
    <div class="page" id="feedingPage">
      <div class="sub-header">
        <button class="back-btn" onclick="showPage('home')">‚óÄ</button>
        <div class="page-title">üçÉ ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°</div>
      </div>
      <div style="padding: 20px;">
        <div class="form-section">
          <div class="section-title" id="feedingTitle">‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤ 14:00 ‡∏ô. - ‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£!</div>
          <p id="feedingDetail">‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà 3 ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡∏™‡∏î 1.5 ‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°</p>
          <button class="action-btn" onclick="markFeedingDone()" style="width: 100%; margin-top: 15px;">
            ‚úÖ ‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß
          </button>
        </div>
      </div>
    </div>

    <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô -->
    <div class="page" id="temperaturePage">
      <div class="sub-header">
        <button class="back-btn" onclick="showPage('home')">‚óÄ</button>
        <div class="page-title">üå°Ô∏è ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô</div>
      </div>
      <div style="padding: 20px;">
        <div class="form-section">
          <div class="section-title">‡∏™‡∏†‡∏≤‡∏û‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div>
          <div style="text-align: center; margin: 20px 0;">
            <div style="font-size: 36px; color: #f57c00;">üå°Ô∏è 28¬∞C</div>
            <div style="color: #f57c00;">‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ</div>
            <div style="font-size: 36px; color: #4caf50; margin-top: 15px;">üíß 75%</div>
            <div style="color: #4caf50;">‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°</div>
          </div>
          <button class="action-btn" onclick="controlTemperature()" style="width: 100%;">
            üí® ‡πÄ‡∏õ‡∏¥‡∏î‡∏û‡∏±‡∏î‡∏•‡∏°‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô
          </button>
        </div>
      </div>
    </div>

    <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î -->
    <div class="page" id="cleaningPage">
      <div class="sub-header">
        <button class="back-btn" onclick="showPage('home')">‚óÄ</button>
        <div class="page-title">üßπ ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÇ‡∏£‡∏á‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</div>
      </div>
      <div style="padding: 20px;">
        <div class="form-section">
          <div class="section-title">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î</div>
          <div style="margin: 15px 0;">
            <label style="display: flex; align-items: center; padding: 10px; background: #f5f5f5; border-radius: 8px;">
              <input type="checkbox" style="margin-right: 10px; transform: scale(1.5);" />
              1. ‡πÄ‡∏Å‡πá‡∏ö‡∏°‡∏π‡∏•‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°
            </label>
          </div>
          <div style="margin: 15px 0;">
            <label style="display: flex; align-items: center; padding: 10px; background: #f5f5f5; border-radius: 8px;">
              <input type="checkbox" style="margin-right: 10px; transform: scale(1.5);" />
              2. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏£‡∏≠‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£
            </label>
          </div>
          <button class="action-btn" onclick="completeCleaning()" style="width: 100%; margin-top: 15px;">
            ‚úÖ ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
          </button>
        </div>
      </div>
    </div>

    <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡πà‡∏≤‡∏¢‡∏°‡∏π‡∏•‡∏Ç‡∏¢‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà -->
    <div class="page" id="wastePage">
      <div class="sub-header">
        <button class="back-btn" onclick="showPage('home')">‚óÄ</button>
        <div class="page-title">üóëÔ∏è ‡∏ñ‡πà‡∏≤‡∏¢‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏Ç‡∏¢‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</div>
      </div>
      <div style="padding: 20px;">
        <div class="form-section">
          <div class="section-title">‚ö†Ô∏è ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å!</div>
          <p>‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà 3 ‡∏ï‡πâ‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏Ç‡∏¢‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</p>
          <div style="margin: 15px 0;">
            <strong>‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥:</strong><br />
            ‚Ä¢ ‡∏ñ‡πà‡∏≤‡∏¢‡∏°‡∏π‡∏•‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÉ‡∏ï‡πâ‡πÅ‡∏ú‡πà‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á<br />
            ‚Ä¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ú‡πà‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà 5 ‡πÅ‡∏ú‡πà‡∏ô<br />
            ‚Ä¢ ‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏ó‡πà‡∏≤ ‡πÜ ‡∏Å‡∏±‡∏ô
          </div>
          <button class="action-btn" onclick="completeWasteManagement()" style="width: 100%;">
            ‚úÖ ‡∏ó‡∏≥‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß
          </button>
        </div>
      </div>
    </div>

    <!-- ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÇ‡∏£‡∏Ñ -->
    <div class="page" id="diseasePage">
      <div class="sub-header">
        <button class="back-btn" onclick="showPage('home')">‚óÄ</button>
        <div class="page-title">ü¶† ‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÇ‡∏£‡∏Ñ‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°</div>
      </div>
      <div style="padding: 20px;">
        <div class="form-section">
          <div class="section-title">‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°</div>
          <div style="text-align: center; margin: 20px 0;">
            <div style="font-size: 48px;">üòä</div>
            <div style="font-size: 24px; color: #4caf50; font-weight: bold;">‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏î‡∏µ</div>
            <div>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥</div>
          </div>
          <button class="action-btn" onclick="startHealthCheck()" style="width: 100%; margin-bottom: 10px;">
            üëÅÔ∏è ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û
          </button>
          <button class="action-btn" onclick="showPage('report')" style="width: 100%; background: #f44336;">
            üìã ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÇ‡∏£‡∏Ñ
          </button>
        </div>
      </div>
    </div>

    <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô -->
    <div class="page" id="planningPage">
      <div class="sub-header">
        <button class="back-btn" onclick="showPage('home')">‚óÄ</button>
        <div class="page-title">üìã ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÑ‡∏´‡∏°</div>
      </div>
      <div style="padding: 20px;">
        <div class="form-section">
          <div class="section-title">‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÉ‡∏´‡∏°‡πà - ‡∏£‡∏∏‡πà‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
          <div style="margin: 15px 0;">
            <label>‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô:</label>
            <input type="date" class="input-field" id="plan-start-date" />
          </div>
          <div style="margin: 15px 0;">
            <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏Ç‡πà‡πÑ‡∏´‡∏°:</label>
            <select class="input-field" id="plan-egg-sheets">
              <option value="1">1 ‡πÅ‡∏ú‡πà‡∏ô</option>
              <option value="2">2 ‡πÅ‡∏ú‡πà‡∏ô</option>
              <option value="3">3 ‡πÅ‡∏ú‡πà‡∏ô</option>
              <option value="4">4 ‡πÅ‡∏ú‡πà‡∏ô</option>
              <option value="5">5 ‡πÅ‡∏ú‡πà‡∏ô</option>
            </select>
          </div>
          <button class="action-btn" onclick="createNewPlan()" style="width: 100%;">
            ‚ú® ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô
          </button>
        </div>
      </div>
    </div>

    <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
    <div class="page" id="recordingPage">
      <div class="sub-header">
        <button class="back-btn" onclick="showPage('home')">‚óÄ</button>
        <div class="page-title">üìä ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</div>
      </div>
      <div style="padding: 20px;">
        <div class="form-section">
          <div class="section-title">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>

          <div style="margin: 15px 0;">
            <label>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏° (‡∏Å‡∏Å.):</label>
            <input id="log-worm-weight" type="number" class="input-field" placeholder="0.0" step="0.1" />
          </div>

          <div style="margin: 15px 0;">
            <label>‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (‡∏Å‡∏Å.):</label>
            <input id="log-food-weight" type="number" class="input-field" placeholder="0.0" step="0.1" />
          </div>

          <div style="margin: 15px 0;">
            <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</label>
            <textarea id="log-note" class="input-field" rows="3" placeholder="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡πÄ‡∏´‡πá‡∏ô..."></textarea>
          </div>

          <button class="action-btn" onclick="saveRecord()" style="width: 100%;">
            üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
          </button>
        </div>
      </div>
    </div>

    <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÇ‡∏£‡∏Ñ -->
    <div class="page" id="reportPage">
      <div class="sub-header">
        <button class="back-btn" onclick="showPage('home')">‚óÄ</button>
        <div class="page-title">üìã ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÇ‡∏£‡∏Ñ‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°</div>
      </div>
      <div style="padding: 20px;">
        <div class="form-section">
          <div class="section-title">üö® ‡πÅ‡∏à‡πâ‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏ö‡πÇ‡∏£‡∏Ñ‡∏î‡πà‡∏ß‡∏ô</div>
          <div style="margin: 15px 0;">
            <label>‡∏ä‡∏ô‡∏¥‡∏î‡πÇ‡∏£‡∏Ñ:</label>
            <select class="input-field">
              <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏£‡∏Ñ</option>
              <option value="pebrine">‡πÇ‡∏£‡∏Ñ‡∏õ‡∏•‡∏¥‡∏á (Pebrine)</option>
              <option value="muscardine">‡πÇ‡∏£‡∏Ñ‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏£‡∏≤ (Muscardine)</option>
              <option value="flacherie">‡πÇ‡∏£‡∏Ñ‡∏ó‡πâ‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢ (Flacherie)</option>
            </select>
          </div>
          <div style="margin: 15px 0;">
            <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á:</label>
            <select class="input-field">
              <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö</option>
              <option value="low">‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢</option>
              <option value="medium">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
              <option value="high">‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á</option>
              <option value="critical">‡∏ß‡∏¥‡∏Å‡∏§‡∏ï</option>
            </select>
          </div>
          <button class="action-btn" style="width: 100%; background: #f44336;">
            üì§ ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (mock-up)
          </button>
        </div>
      </div>
    </div>

    <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ -->
    <div class="page" id="statisticsPage">
      <div class="sub-header">
        <button class="back-btn" onclick="showPage('home')">‚óÄ</button>
        <div class="page-title">üìà ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÑ‡∏´‡∏°</div>
      </div>
      <div style="padding: 20px;">
        <div class="report-main-card">

          <h2 class="report-title">üìä ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï &amp; ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</h2>
          <p class="report-subtitle">
            ‡∏î‡∏π‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡πÑ‡∏´‡∏° ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏≠‡∏ö ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏£‡∏≤‡∏ü‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à
          </p>

          <div class="report-block">
            <h3>‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡∏£‡∏≠‡∏ö‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
            <ul>
              <li><strong>‡∏£‡∏∏‡πà‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á:</strong> ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà 5</li>
              <li><strong>‡πÄ‡∏™‡πâ‡∏ô‡πÑ‡∏´‡∏°‡∏£‡∏ß‡∏°:</strong> 12.5 ‡∏Å‡∏Å.</li>
              <li><strong>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏£‡∏≠‡∏î:</strong> 89%</li>
              <li><strong>‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏£‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤:</strong> ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô +8%</li>
            </ul>
          </div>

          <div class="report-block report-grid-2">
            <div>
              <h3>‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏µ</h3>
              <ul>
                <li><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≠‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á:</strong> 4 ‡∏£‡∏≠‡∏ö</li>
                <li><strong>‡πÄ‡∏™‡πâ‡∏ô‡πÑ‡∏´‡∏°‡∏£‡∏ß‡∏°:</strong> 45.8 ‡∏Å‡∏Å.</li>
                <li><strong>‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏ö:</strong> 11.45 ‡∏Å‡∏Å.</li>
              </ul>
            </div>
            <div>
              <h3>‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</h3>
              <ul>
                <li>‚ùñ ‡∏£‡∏≠‡∏ö‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î: ‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà 3</li>
                <li>‚ùñ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°: 75‚Äì80%</li>
                <li>‚ùñ ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: 26‚Äì28 ¬∞C</li>
              </ul>
            </div>
          </div>

          <div class="report-block">
            <div class="report-table-header">
              <h3>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡πÑ‡∏´‡∏°</h3>
              <div class="report-filters">
                <select>
                  <option>‡∏õ‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                  <option>2567</option>
                  <option>2568</option>
                </select>
                <select>
                  <option>‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÑ‡∏´‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                  <option>‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÑ‡∏ó‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô</option>
                  <option>‡∏•‡∏π‡∏Å‡∏ú‡∏™‡∏°</option>
                </select>
                <button class="btn-outline">Export CSV</button>
                <button class="btn-filled">Export PDF</button>
              </div>
            </div>

            <div class="report-table-wrapper">
              <table class="report-table">
                <thead>
                  <tr>
                    <th>‡∏£‡∏≠‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</th>
                    <th>‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÑ‡∏´‡∏°</th>
                    <th>‡πÅ‡∏ú‡πà‡∏ô‡πÑ‡∏Ç‡πà (‡πÅ‡∏ú‡πà‡∏ô)</th>
                    <th>‡πÄ‡∏™‡πâ‡∏ô‡πÑ‡∏´‡∏° (‡∏Å‡∏Å.)</th>
                    <th>‡∏£‡∏±‡∏á‡πÑ‡∏´‡∏° (‡∏Å‡∏Å.)</th>
                    <th>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏£‡∏≠‡∏î (%)</th>
                    <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà 5</td>
                    <td>‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÑ‡∏ó‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô</td>
                    <td>3</td>
                    <td>12.5</td>
                    <td>38.0</td>
                    <td>89%</td>
                    <td>‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°</td>
                  </tr>
                  <tr>
                    <td>‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà 4</td>
                    <td>‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏•‡∏π‡∏Å‡∏ú‡∏™‡∏°</td>
                    <td>3</td>
                    <td>11.2</td>
                    <td>35.4</td>
                    <td>82%</td>
                    <td>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏™‡∏π‡∏á</td>
                  </tr>
                  <tr>
                    <td>‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà 3</td>
                    <td>‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÑ‡∏ó‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô</td>
                    <td>2</td>
                    <td>12.8</td>
                    <td>37.2</td>
                    <td>92%</td>
                    <td>‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏õ‡∏µ</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div class="report-block">
            <h3>‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï</h3>
            <p class="report-note">
              ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡πÄ‡∏™‡πâ‡∏ô‡πÑ‡∏´‡∏° ‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏£‡∏≠‡∏î‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á
            </p>
                      <!-- ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á -->
          <div class="report-block" id="feedingLogsBlock">
            <h3>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</h3>
            <p class="report-note">
              ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏° "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á" (‡πÅ‡∏™‡∏î‡∏á 10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)
            </p>

            <div class="report-table-wrapper">
              <table class="report-table" id="feedingLogsTable">
                <thead>
                  <tr>
                    <th>‡∏£‡∏∏‡πà‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</th>
                    <th>‡∏ß‡∏±‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏ó‡∏µ‡πà</th>
                    <th>‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà</th>
                    <th>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏´‡∏ô‡∏≠‡∏ô (‡∏Å‡∏Å.)</th>
                    <th>‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (‡∏Å‡∏Å.)</th>
                    <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td colspan="5">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

            
            <div class="chart-placeholder">
              ‡∏Å‡∏£‡∏≤‡∏ü‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡πÄ‡∏™‡πâ‡∏ô‡πÑ‡∏´‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏ö (‡∏Å‡∏Å.)
              <canvas id="productionChart"></canvas>
            </div>

            <div class="chart-placeholder" style="margin-top: 10px;">
              ‡∏Å‡∏£‡∏≤‡∏ü‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏£‡∏≠‡∏î‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏ö (%)
              <canvas id="survivalChart"></canvas>
            </div>
          </div>

          <div class="report-block">
            <h3>‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</h3>
            <p>
              ‡∏£‡∏≠‡∏ö‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏°‡∏µ‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ 1.3 ‡∏Å‡∏Å. ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà 78%
              ‡∏ã‡∏∂‡πà‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ô‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠
            </p>
            <p>
              ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà 3 ‡πÅ‡∏•‡∏∞ 5 ‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô
              ‡πÅ‡∏•‡∏∞‡∏à‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô
            </p>
          </div>

        </div>
      </div>
    </div>

    <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ -->
    <div class="page" id="settingsPage">
      <div class="sub-header">
        <button class="back-btn" onclick="showPage('home')">‚óÄ</button>
        <div class="page-title">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏õ</div>
      </div>
      <div style="padding: 20px;">
        <div class="form-section">
          <div class="section-title">‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>
          <div class="setting-row">
            <div class="setting-label">
              ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÑ‡∏´‡∏°
            </div>
            <label class="switch">
              <input
                type="checkbox"
                id="toggleNotifications"
                onchange="onNotificationToggle(this.checked)"
              />
              <span class="slider"></span>
            </label>
          </div>
          <div id="notifyStatusText" class="setting-note">
            ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
          </div>
        </div>
      </div>
    </div>

  </div> <!-- /container -->

  <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô -->
  <button class="emergency-btn" onclick="emergency()" title="‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô - ‡πÇ‡∏ó‡∏£‡∏Ç‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠">
    üö®
  </button>

  <!-- Bottom Navigation -->
  <div class="bottom-nav">
    <div class="nav-item active" data-page="home" onclick="showPage('home')">
      <span class="nav-icon">üè†</span>
      <div class="nav-text">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</div>
    </div>
    <div class="nav-item" data-page="statistics" onclick="showPage('statistics')">
      <span class="nav-icon">üìà</span>
      <div class="nav-text">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</div>
    </div>
    <div class="nav-item" data-page="settings" onclick="showPage('settings')">
      <span class="nav-icon">‚öôÔ∏è</span>
      <div class="nav-text">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</div>
    </div>
    <div class="nav-item" data-page="logout" onclick="logout()">
      <span class="nav-icon">üì¶</span>
      <div class="nav-text">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</div>
    </div>
  </div>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script>
    /* -------------------------
       ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡∏•‡∏±‡∏Å
    ------------------------- */
    let productionChartInstance = null;
    let survivalChartInstance = null;

    // ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (default = true)
    let notificationEnabled = true;

    /* -------------------------
       ‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£ 27 ‡∏ß‡∏±‡∏ô (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠)
    ------------------------- */
    const FEEDING_PLAN = [
      { day: 1, stage: 1, times: ["07:00", "11:00", "16:00"], note: "‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡∏≠‡πà‡∏≠‡∏ô" },
      { day: 2, stage: 1, times: ["07:00", "11:00", "16:00"], note: "‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡∏≠‡πà‡∏≠‡∏ô" },
      { day: 3, stage: 1, times: ["07:00", "11:00", "16:00"], note: "‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡∏≠‡πà‡∏≠‡∏ô" },

      { day: 4, stage: 2, times: ["07:00", "11:00", "16:00"], note: "‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡∏≠‡πà‡∏≠‡∏ô" },
      { day: 5, stage: 2, times: ["07:00", "11:00", "16:00"], note: "‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡∏≠‡πà‡∏≠‡∏ô" },
      { day: 6, stage: 2, times: ["07:00", "11:00", "16:00"], note: "‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ñ‡πà‡∏≤‡∏¢‡∏°‡∏π‡∏•‡∏£‡∏≠‡∏ö‡πÅ‡∏£‡∏Å" },

      { day: 7, stage: 3, times: ["07:00", "13:00", "18:00"], note: "‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡∏™‡∏î 1.0 ‡∏Å‡∏Å." },
      { day: 8, stage: 3, times: ["07:00", "13:00", "18:00"], note: "‡∏ñ‡πà‡∏≤‡∏¢‡∏°‡∏π‡∏• + ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà" },
      { day: 9, stage: 3, times: ["07:00", "13:00", "18:00"], note: "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô" },
      { day: 10, stage: 3, times: ["07:00", "13:00", "18:00"], note: "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û" },
      { day: 11, stage: 3, times: ["07:00", "13:00", "18:00"], note: "‡∏ñ‡πà‡∏≤‡∏¢‡∏°‡∏π‡∏• + ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ú‡πà‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á" },

      { day: 12, stage: 4, times: ["08:00", "17:00"], note: "‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô" },
      { day: 13, stage: 4, times: ["08:00", "17:00"], note: "‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡∏¢‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà" },
      { day: 14, stage: 4, times: ["08:00", "17:00"], note: "‡∏ñ‡πà‡∏≤‡∏¢‡∏°‡∏π‡∏• + ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà" },
      { day: 15, stage: 4, times: ["08:00", "17:00"], note: "‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô" },
      { day: 16, stage: 4, times: ["08:00", "17:00"], note: "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û" },

      { day: 17, stage: 5, times: ["09:00", "17:00"], note: "‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏ß‡∏±‡∏¢‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢" },
      { day: 18, stage: 5, times: ["09:00", "17:00"], note: "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å" },
      { day: 19, stage: 5, times: ["09:00", "17:00"], note: "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û" },
      { day: 20, stage: 5, times: ["09:00", "17:00"], note: "‡∏ñ‡πà‡∏≤‡∏¢‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏´‡∏ç‡πà" },
      { day: 21, stage: 5, times: ["09:00", "17:00"], note: "‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ñ‡∏≠‡∏ô‡∏ó‡∏≥‡∏£‡∏±‡∏á" },
      { day: 22, stage: 5, times: [], note: "‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏∏‡∏Å ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£" },

      { day: 23, stage: "‡πÑ‡∏´‡∏°‡∏™‡∏∏‡∏Å", times: [], note: "‡∏´‡∏¢‡∏∏‡∏î‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£ - ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≤‡∏ß‡πÑ‡∏´‡∏°" },
      { day: 24, stage: "‡∏™‡∏≤‡∏ß‡πÑ‡∏´‡∏°", times: [], note: "‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏á‡πÑ‡∏´‡∏°" },
      { day: 25, stage: "‡∏™‡∏≤‡∏ß‡πÑ‡∏´‡∏°", times: [], note: "‡∏™‡∏≤‡∏ß‡πÑ‡∏´‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á" },
      { day: 26, stage: "‡∏™‡∏≤‡∏ß‡πÑ‡∏´‡∏°", times: [], note: "‡∏™‡∏≤‡∏ß‡πÑ‡∏´‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á" },
      { day: 27, stage: "‡∏™‡∏≤‡∏ß‡πÑ‡∏´‡∏°", times: [], note: "‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î" }
    ];

    /* -------------------------
       ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ß‡∏±‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á
    ------------------------- */
    function getDayNoFromStart(startDateStr, today) {
      if (!startDateStr) return null;
      const start = new Date(startDateStr);
      const ONE_DAY = 24 * 60 * 60 * 1000;
      const diff = Math.floor((today - start) / ONE_DAY) + 1; // ‡∏ß‡∏±‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏ó‡∏µ‡πà ...
      return diff;
    }

    function updateCurrentStageText() {
      const startStr = localStorage.getItem("silkStartDate");
      const today = new Date();
      const dayNo = getDayNoFromStart(startStr, today);
      const el = document.getElementById("currentStageText");

      if (!el) return;

      if (!dayNo || dayNo <= 0) {
        el.textContent = "üìÖ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á";
        return;
      }

      const plan = FEEDING_PLAN.find(p => p.day === dayNo);
      const stageText = plan ? `‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà ${plan.stage}` : "‡∏ô‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÅ‡∏ú‡∏ô 27 ‡∏ß‡∏±‡∏ô";
      el.textContent = `üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${dayNo} ${stageText}`;
    }

    /* -------------------------
       ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£
    ------------------------- */
    function updateFeedingPage() {
      const startStr = localStorage.getItem("silkStartDate");
      const titleEl = document.getElementById("feedingTitle");
      const detailEl = document.getElementById("feedingDetail");

      if (!startStr) {
        if (titleEl) titleEl.textContent = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á";
        if (detailEl) detailEl.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏ô‡∏π‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡πà‡∏∞";
        return;
      }

      const today = new Date();
      const dayNo = getDayNoFromStart(startStr, today);
      const plan = FEEDING_PLAN.find(p => p.day === dayNo);

      if (!plan) {
        if (titleEl) titleEl.textContent = `‡∏ß‡∏±‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏ó‡∏µ‡πà ${dayNo} (‡∏ô‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÅ‡∏ú‡∏ô 27 ‡∏ß‡∏±‡∏ô)`;
        if (detailEl) detailEl.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏£‡∏∏‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á";
        return;
      }

      const timeText =
        plan.times.length > 0 ? plan.times.join(" ‚Ä¢ ") : "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£";

      if (titleEl) {
        titleEl.textContent = `‚è∞ ‡∏ß‡∏±‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏ó‡∏µ‡πà ${dayNo} ‚Äî ${timeText}`;
      }

      if (detailEl) {
        detailEl.textContent = `‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà ${plan.stage} : ${plan.note}`;
      }
      // üîà ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏û‡∏π‡∏î‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏ú‡∏ô‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£
  speakFeedingPlan(dayNo, plan);
    }

    /* -------------------------
       ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
    ------------------------- */
    function speakThai(text) {
      if (!("speechSynthesis" in window)) {
        return;
      }
      const u = new SpeechSynthesisUtterance(text);
      u.lang = "th-TH";
      u.rate = 1;
      window.speechSynthesis.cancel();
      window.speechSynthesis.speak(u);
    }

    function emergency() {
      alert("üìû ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÇ‡∏ó‡∏£‡∏´‡∏≤‡∏•‡∏π‡∏Å‡∏´‡∏•‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (‡∏à‡∏≥‡∏•‡∏≠‡∏á)");
    }

    function takePhoto() {
      alert("üì∑ ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û (‡∏à‡∏≥‡∏•‡∏≠‡∏á)");
    }

    function callFamily() {
      alert("üìû ‡πÇ‡∏ó‡∏£‡∏´‡∏≤‡∏•‡∏π‡∏Å‡∏´‡∏•‡∏≤‡∏ô (‡∏à‡∏≥‡∏•‡∏≠‡∏á)");
    }

    function completeCleaning() {
      alert("üßπ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÅ‡∏•‡πâ‡∏ß");
    }

    function completeWasteManagement() {
      alert("üóëÔ∏è ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏Ç‡∏¢‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß");
    }

    function startHealthCheck() {
      alert("üîç ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏° (‡∏à‡∏≥‡∏•‡∏≠‡∏á)");
    }

    function controlTemperature() {
      alert("üí® ‡πÄ‡∏õ‡∏¥‡∏î‡∏û‡∏±‡∏î‡∏•‡∏°‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô (‡∏à‡∏≥‡∏•‡∏≠‡∏á)");
    }

    function logout() {
      // ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ login (‡πÅ‡∏Å‡πâ‡∏ï‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡πÑ‡∏î‡πâ)
      window.location.href = "index.html";
    }

    /* -------------------------
       ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á
    ------------------------- */
 function createNewPlan() {
  // ‡∏´‡∏≤ input ‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏Ç‡πà‡πÑ‡∏´‡∏° ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ planningPage
  const dateInput = document.querySelector(
    "#planningPage input[type='date']"
  );
  const eggsSelect = document.querySelector("#planningPage select");

  const startDate = dateInput ? dateInput.value : "";
  const eggs = eggsSelect ? eggsSelect.value : "";

  if (!startDate) {
    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡πà‡∏∞");
    return;
  }

  // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á (‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏ú‡∏ô‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£)
  localStorage.setItem("silkStartDate", startDate);

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡∏£‡∏∏‡πà‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÅ‡∏ö‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô 2025-11-09_2‡πÅ‡∏ú‡πà‡∏ô
  const batchId = `${startDate}_‡πÑ‡∏Ç‡πà${eggs}‡πÅ‡∏ú‡πà‡∏ô`;
  localStorage.setItem("silkCurrentBatchId", batchId);

  alert(
    "‚ú® ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∏‡πà‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞\n‡∏£‡∏´‡∏±‡∏™‡∏£‡∏∏‡πà‡∏ô: " +
      batchId
  );
}

// --------------------------
// ‡∏û‡∏π‡∏î‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏ú‡∏ô‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (Text-to-Speech)
// --------------------------
function speakFeedingPlan(dayNo, plan) {
  try {
    // ‡∏ñ‡πâ‡∏≤ browser ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö ‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏¥‡∏î‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô ‡πÑ‡∏°‡πà‡∏ô‡∏≥‡∏°‡∏≤‡πÉ‡∏ä‡πâ
    if (!('speechSynthesis' in window)) return;

    const alertEnabled = localStorage.getItem('silkAlertEnabled') === '1';
    if (!alertEnabled) return;

    // ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏î‡∏¥‡∏°‡∏Å‡πà‡∏≠‡∏ô
    window.speechSynthesis.cancel();

    // ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á
    const text =
      `‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏ó‡∏µ‡πà ${dayNo} ` +
      `‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°‡πÄ‡∏ß‡∏•‡∏≤ ${plan.times.join(' ‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤, ')} ‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤ ` +
      `‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà ${plan.stage} ${plan.note}`;
    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = 'th-TH';   // ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
    utter.rate = 0.9;       // ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß
    utter.pitch = 1.0;      // ‡πÇ‡∏ó‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á

    window.speechSynthesis.speak(utter);
  } catch (err) {
    console.error('speakFeedingPlan error:', err);
  }
}

    /* -------------------------
       ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
    ------------------------- */
    function loadNotificationPreference() {
      const saved = localStorage.getItem("notifyEnabled");
      if (saved === null) {
        notificationEnabled = true;
      } else {
        notificationEnabled = saved === "true";
      }

      const checkbox = document.getElementById("toggleNotifications");
      const statusText = document.getElementById("notifyStatusText");

      if (checkbox) {
        checkbox.checked = notificationEnabled;
      }
      if (statusText) {
        statusText.textContent = notificationEnabled
          ? "‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥"
          : "‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏π‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÑ‡∏î‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á";
      }
    }

    function onNotificationToggle(checked) {
      notificationEnabled = checked;
      localStorage.setItem("notifyEnabled", String(notificationEnabled));

      const statusText = document.getElementById("notifyStatusText");
      if (statusText) {
        statusText.textContent = notificationEnabled
          ? "‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥"
          : "‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏π‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÑ‡∏î‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á";
      }

      alert(
        notificationEnabled
          ? "‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß"
          : "‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‚Äî ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£"
      );
    }

   // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å function ‡πÄ‡∏õ‡πá‡∏ô async function
async function markFeedingDone() {
  if (notificationEnabled) {
    speakThai(
      "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏≠‡∏ö‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏Ñ‡πà‡∏∞"
    );
    alert("üçÉ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏≠‡∏ö‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥");

    // ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡πÉ‡∏ä‡πâ await ‡πÑ‡∏î‡πâ
    await logPlannedFeedingToSupabase();
  } else {
    alert("üçÉ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß (‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏¥‡∏î‡πÑ‡∏ß‡πâ)");
  }
}


    function startVoiceCommand() {
      const startStr = localStorage.getItem("silkStartDate");
      const today = new Date();
      const dayNo = getDayNoFromStart(startStr, today);
      const plan = dayNo ? FEEDING_PLAN.find(p => p.day === dayNo) : null;

      let msg = "";

      if (!dayNo || !plan) {
        msg = "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÅ‡∏ú‡∏ô 27 ‡∏ß‡∏±‡∏ô‡∏Ñ‡πà‡∏∞";
      } else {
        const timeText =
          plan.times.length > 0
            ? plan.times.join(" ‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤ ‡πÅ‡∏•‡∏∞ ")
            : "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£";
        msg =
          "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏ó‡∏µ‡πà " +
          dayNo +
          " ‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà " +
          plan.stage +
          " ‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Ñ‡∏∑‡∏≠ " +
          timeText +
          " ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ " +
          plan.note +
          " ";
      }

      if (notificationEnabled) {
        msg += "‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏≠‡∏¢‡∏π‡πà‡∏Ñ‡πà‡∏∞ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Ñ‡πà‡∏∞";
      } else {
        msg += "‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Ñ‡πà‡∏∞";
      }

      speakThai(msg);
    }

    /* -------------------------
       Supabase Config (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô)
    ------------------------- */
    const SUPABASE_URL = "https://dpgnqrxanxyxhibkfspx.supabase.co";
    const SUPABASE_ANON_KEY =
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRwZ25xcnhhbnh5eGhpYmtmc3B4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMwMjU5NjksImV4cCI6MjA3ODYwMTk2OX0.CTWYu4ZxS_gW6G4r0zGNNj6gVkNE6jSWmcGoXc6GaxI";
    /* --------------------------
   ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô (‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß")
--------------------------- */
async function logPlannedFeedingToSupabase() {
  // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á ‡πÉ‡∏´‡πâ‡∏´‡∏¢‡∏∏‡∏î
  const stored = localStorage.getItem("silkStartDate");
  if (!stored) {
    console.warn("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á ‡∏à‡∏∂‡∏á‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Supabase");
    return;
  }

  const startDate = new Date(stored);
  const now = new Date();

  // ‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏ú‡∏ô‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (D, ‡∏ß‡∏±‡∏¢ ‡∏Ø‡∏•‡∏Ø)
  // ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏î‡∏¥‡∏°‡∏ß‡πà‡∏≤ getFeedingPlanForDate
  const planResult = typeof getFeedingPlanForDate === "function"
    ? getFeedingPlanForDate(startDate, now)
    : null;

  if (!planResult || !planResult.plan) {
    console.warn("‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÅ‡∏ú‡∏ô / ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• plan ‡∏à‡∏∂‡∏á‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Supabase");
    return;
  }

  const { dayNo, plan } = planResult;

  // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö batch_id ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ null ‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô
  const currentBatchId = 
    localStorage.getItem("silkCurrentBatchId") ||null;

  // ‡πÄ‡∏ß‡∏•‡∏≤ ‡∏ì ‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏™‡πà‡πÉ‡∏ô‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏
  const timeText = now.toLocaleTimeString("th-TH", {
    hour: "2-digit",
    minute: "2-digit",
  });

  try {
    const response = await fetch(`${SUPABASE_URL}/rest/v1/feeding_logs`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        apikey: SUPABASE_ANON_KEY,
        Authorization: `Bearer ${SUPABASE_ANON_KEY}`,
        Prefer: "return=representation",
      },
      body: JSON.stringify({
        batch_id: currentBatchId,
        day_in_cycle: dayNo,              // ‡∏ß‡∏±‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏£
        age_stage: plan.stage || null,    // ‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏£ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÉ‡∏ô plan)
        worm_weight_kg: null,             // ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å
        mulberry_weight_kg: null,         // ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏≠‡∏≤‡∏´‡∏≤‡∏£
        note: `‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô ‡πÄ‡∏ß‡∏•‡∏≤ ${timeText}`, // ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏
      }),
    });

    if (!response.ok) {
      const errText = await response.text();
      console.error("Supabase feeding_logs error:", errText);
      alert("‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
      return;
    }

    console.log("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏•‡∏á Supabase ‡πÅ‡∏•‡πâ‡∏ß");
  } catch (error) {
    console.error("Supabase error:", error);
    alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Supabase");
  }
}
async function saveRecord() {
  const wormWeight = parseFloat(
    document.getElementById("log-worm-weight").value || 0
  );
  const foodWeight = parseFloat(
    document.getElementById("log-food-weight").value || 0
  );
  const note = document.getElementById("log-note").value || "";

  // ‚úÖ ‡∏î‡∏∂‡∏á batch ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏à‡∏≤‡∏Å localStorage
  const currentBatchId =
    localStorage.getItem("silkCurrentBatchId") || null;

  if (!wormWeight && !foodWeight && !note.trim()) {
    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏ä‡πà‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏∞");
    return;
  }

  try {
    const response = await fetch(
      `${SUPABASE_URL}/rest/v1/feeding_logs`,
      {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          apikey: SUPABASE_ANON_KEY,
          Authorization: `Bearer ${SUPABASE_ANON_KEY}`,
          Prefer: "return=representation",
        },
        body: JSON.stringify({
          batch_id: currentBatchId,      // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
          day_in_cycle: 1,
          age_stage: 3,
          worm_weight_kg: wormWeight,
          mulberry_weight_kg: foodWeight,
          note: note,
        }),
      }
    );

    if (!response.ok) {
      const errText = await response.text();
      console.error(errText);
      alert("‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
      return;
    }

    alert("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞!");

    document.getElementById("log-worm-weight").value = "";
    document.getElementById("log-food-weight").value = "";
    document.getElementById("log-note").value = "";
  } catch (error) {
    console.error(error);
    alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠");
  }
}


/* --------------------------
   ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏à‡∏≤‡∏Å Supabase (feeding_logs)
--------------------------- */
async function loadFeedingStats() {
  const table = document.querySelector("#feedingLogsTable tbody");
  if (!table) return;

  try {
    const response = await fetch(
      `${SUPABASE_URL}/rest/v1/feeding_logs?select=day_in_cycle,age_stage,worm_weight_kg,mulberry_weight_kg,note,created_at&order=created_at.asc`,
      {
        headers: {
          apikey: SUPABASE_ANON_KEY,
          Authorization: `Bearer ${SUPABASE_ANON_KEY}`,
        },
      }
    );

    if (!response.ok) {
      console.error("‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:", await response.text());
      return;
    }

    const rows = await response.json();
    renderFeedingLogsTable(rows);
  } catch (err) {
    console.error("loadFeedingStats error:", err);
  }
}

function renderFeedingLogsTable(rows) {
  const tbody = document.querySelector("#feedingLogsTable tbody");
  if (!tbody) return;

  tbody.innerHTML = "";

  if (!rows || rows.length === 0) {
    tbody.innerHTML = `<tr><td colspan="6">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>`;
    return;
  }

  // ‡πÄ‡∏≠‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞ 10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡πÉ‡∏´‡∏°‡πà ‚Üí ‡πÄ‡∏Å‡πà‡∏≤
  const latest = rows.slice(0, 10);

  for (const row of latest) {
    const batch = row.batch_id || "-";
    const day = row.day_in_cycle ?? "-";
    const stage = row.age_stage ?? "-";
    const worm = row.worm_weight_kg != null ? row.worm_weight_kg.toFixed(2) : "-";
    const food =
      row.mulberry_weight_kg != null ? row.mulberry_weight_kg.toFixed(2) : "-";
    const note = row.note || "";

    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${batch}</td>
      <td>${day}</td>
      <td>${stage}</td>
      <td>${worm}</td>
      <td>${food}</td>
      <td>${note}</td>
    `;

    tbody.appendChild(tr);
  }
}

        document.getElementById("log-worm-weight").value = "";
        document.getElementById("log-food-weight").value = "";
        document.getElementById("log-note").value = "";
      } catch (error) {
        console.error(error);
        alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠");
      }
    }

    /* -------------------------
       Chart.js
    ------------------------- */
    function initCharts() {
      if (typeof Chart === "undefined") return;

      const productionCanvas = document.getElementById("productionChart");
      const survivalCanvas = document.getElementById("survivalChart");
      if (!productionCanvas || !survivalCanvas) return;

      const labels = ["‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà 3", "‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà 4", "‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà 5"];
      const silkWeights = [12.8, 11.2, 12.5];
      const survivalRates = [92, 82, 89];

      if (productionChartInstance) productionChartInstance.destroy();
      if (survivalChartInstance) survivalChartInstance.destroy();

      productionChartInstance = new Chart(
        productionCanvas.getContext("2d"),
        {
          type: "bar",
          data: {
            labels,
            datasets: [
              {
                label: "‡πÄ‡∏™‡πâ‡∏ô‡πÑ‡∏´‡∏° (‡∏Å‡∏Å.)",
                data: silkWeights
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: true },
              tooltip: {
                callbacks: {
                  label: (ctx) => ` ${ctx.parsed.y.toFixed(1)} ‡∏Å‡∏Å.`
                }
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                title: { display: true, text: "‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°" }
              }
            }
          }
        }
      );

      survivalChartInstance = new Chart(
        survivalCanvas.getContext("2d"),
        {
          type: "line",
          data: {
            labels,
            datasets: [
              {
                label: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏£‡∏≠‡∏î (%)",
                data: survivalRates,
                tension: 0.3
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: true },
              tooltip: {
                callbacks: {
                  label: (ctx) => ` ${ctx.parsed.y.toFixed(0)}%`
                }
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                max: 100,
                title: { display: true, text: "‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå" }
              }
            }
          }
        }
      );
    }

    /* -------------------------
       ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤
    ------------------------- */
    function showPage(pageName) {
      const pages = document.querySelectorAll(".page");
      pages.forEach((p) => p.classList.remove("active"));

      const target = document.getElementById(pageName + "Page");
      if (target) {
        target.classList.add("active");
      } else {
        console.error("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏´‡∏ô‡πâ‡∏≤:", pageName + "Page");
      }

      const navItems = document.querySelectorAll(".nav-item");
      navItems.forEach((item) => {
        item.classList.toggle("active", item.dataset.page === pageName);
      });

      if (pageName === "statistics") {
        initCharts();  // ‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏î‡∏¥‡∏° (mock)
        loadFeedingStats(); // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å Supabase
      }
      if (pageName === "feeding") {
        updateFeedingPage();
      }
    }

    /* -------------------------
       DOM Loaded
    ------------------------- */
    document.addEventListener("DOMContentLoaded", () => {
      showPage("home");
      initCharts();
      loadNotificationPreference();
      updateCurrentStageText();
      updateFeedingPage();
    });
  </script>
</body>
</html>
