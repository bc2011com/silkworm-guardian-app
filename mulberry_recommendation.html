<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÑ‡∏´‡∏°</title>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Sarabun', system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 16px;
      font-size: 18px;
    }

    .container {
      width: 100%;
      max-width: 640px;
      background: #ffffff;
      border-radius: 20px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.08);
      padding: 20px 16px 24px;
    }

    @media (min-width: 768px) {
      .container {
        padding: 24px 24px 28px;
      }
    }

    h1 {
      font-size: 22px;
      margin-bottom: 4px;
      text-align: center;
      color: #1b5e20;
      font-weight: 700;
    }

    .subtitle {
      text-align: center;
      font-size: 15px;
      color: #558b2f;
      margin-bottom: 18px;
    }

    .form-grid {
      display: flex;
      flex-direction: column;
      gap: 14px;
      margin-bottom: 18px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    label {
      font-weight: 600;
      color: #33691e;
      font-size: 16px;
    }

    .hint {
      font-size: 14px;
      color: #757575;
    }

    select,
    input[type="number"] {
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid #c5e1a5;
      font-size: 16px;
      outline: none;
      background-color: #f9fff5;
      transition: border-color 0.2s, box-shadow 0.2s, background-color 0.2s;
      width: 100%;
    }

    select:focus,
    input[type="number"]:focus {
      border-color: #7cb342;
      box-shadow: 0 0 0 2px rgba(124,179,66,0.2);
      background-color: #ffffff;
    }

    input[type="number"]::-webkit-inner-spin-button,
    input[type="number"]::-webkit-outer-spin-button {
      height: 32px;
    }

    .step-label {
      font-size: 14px;
      font-weight: 600;
      color: #9e9d24;
    }

    .actions {
      margin: 8px 0 6px;
      display: flex;
      justify-content: center;
    }

    button {
      padding: 10px 22px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-size: 18px;
      font-weight: 600;
      background: linear-gradient(135deg, #689f38, #33691e);
      color: #ffffff;
      box-shadow: 0 6px 15px rgba(56,142,60,0.35);
      transition: transform 0.1s ease, box-shadow 0.1s ease, opacity 0.2s;
      width: 100%;
      max-width: 320px;
    }

    button:hover {
      opacity: 0.97;
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(56,142,60,0.45);
    }

    button:active {
      transform: translateY(0);
      box-shadow: 0 4px 10px rgba(56,142,60,0.3);
    }

    .message {
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: 12px;
      font-size: 15px;
      line-height: 1.6;
    }

    .message.error {
      background-color: #ffebee;
      border: 1px solid #ef9a9a;
      color: #b71c1c;
    }

    .message.warning {
      background-color: #fffde7;
      border: 1px solid #fff59d;
      color: #f57f17;
    }

    .result-card {
      margin-top: 12px;
      background-color: #f9fff5;
      border-radius: 14px;
      border: 1px solid #c5e1a5;
      padding: 12px 14px;
      line-height: 1.8;
      font-size: 16px;
    }

    .result-title {
      font-weight: 700;
      font-size: 18px;
      margin-bottom: 4px;
      color: #1b5e20;
    }

    .result-key {
      font-weight: 600;
      color: #33691e;
    }

    .result-highlight {
      font-weight: 700;
      color: #e65100;
    }

    .speak-btn {
      margin-top: 10px;
      padding: 8px 16px;
      font-size: 16px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      background: #43a047;
      color: #fff;
      box-shadow: 0 4px 10px rgba(67,160,71,0.35);
      width: 100%;
    }

    .speak-btn:hover {
      opacity: 0.97;
    }

    .note {
      margin-top: 10px;
      font-size: 13px;
      color: #757575;
      line-height: 1.6;
    }

    hr {
      margin: 16px 0;
      border: none;
      border-top: 1px dashed #c5e1a5;
    }

    .footer {
      margin-top: 10px;
      text-align: center;
      font-size: 12px;
      color: #9e9e9e;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÑ‡∏´‡∏°</h1>
    <div class="subtitle">
      ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÑ‡∏´‡∏° ‚Äì ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏¢
    </div>

    <div class="form-grid">
      <!-- ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÑ‡∏´‡∏° -->
      <div class="form-group">
        <div class="step-label">‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 1</div>
        <label for="breedGroup">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°</label>
        <select id="breedGroup">
          <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå --</option>
          <option value="group_native">‡πÑ‡∏´‡∏°‡πÑ‡∏ó‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô (‡∏£‡∏±‡∏á‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á/‡∏à‡∏≥‡∏õ‡∏≤)</option>
          <option value="group_hybrid_thai">‡πÑ‡∏´‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏•‡∏π‡∏Å‡∏ú‡∏™‡∏° (‡πÑ‡∏ó‡∏¢)</option>
          <option value="group_hybrid_foreign">‡πÑ‡∏´‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏•‡∏π‡∏Å‡∏ú‡∏™‡∏°‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</option>
        </select>
        <div class="hint">
          ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‚Äú‡πÑ‡∏´‡∏°‡πÑ‡∏ó‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‚Äù (‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏ä‡∏∏‡∏°‡∏ä‡∏ô)
        </div>
      </div>

      <!-- ‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏¢‡πà‡∏≠‡∏¢ -->
      <div class="form-group">
        <div class="step-label">‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 2</div>
        <label for="subBreed">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏¢‡πà‡∏≠‡∏¢ (‡∏ñ‡πâ‡∏≤‡∏ó‡∏£‡∏≤‡∏ö)</label>
        <select id="subBreed" disabled>
          <option value="">-- ‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏¢‡πà‡∏≠‡∏¢ --</option>
        </select>
        <div class="hint">
          ‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ ‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏ç‡πà‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
        </div>
      </div>

      <!-- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ú‡πà‡∏ô -->
      <div class="form-group">
        <div class="step-label">‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 3</div>
        <label for="sheetCount">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡πÑ‡∏Ç‡πà‡πÑ‡∏´‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á</label>
        <input
          type="number"
          id="sheetCount"
          min="0.1"
          step="0.1"
          placeholder="‡πÄ‡∏ä‡πà‡∏ô 0.5, 1, 1.5, 2 ‡πÅ‡∏ú‡πà‡∏ô"
        />
        <div class="hint">
          1 ‡πÅ‡∏ú‡πà‡∏ô ‡∏°‡∏µ‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 20,000‚Äì25,000 ‡∏ü‡∏≠‡∏á<br>
          ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡πÅ‡∏ú‡πà‡∏ô ‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà 0.5
        </div>
      </div>

      <!-- ‡∏ß‡∏±‡∏¢‡πÑ‡∏´‡∏° -->
      <div class="form-group">
        <div class="step-label">‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 4</div>
        <label for="instar">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏¢‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°‡πÉ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</label>
        <select id="instar">
          <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏¢‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏° --</option>
          <option value="1">‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà 1 (‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á)</option>
          <option value="2">‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà 2</option>
          <option value="3">‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà 3</option>
          <option value="4">‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà 4</option>
          <option value="5">‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà 5 (‡∏Å‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ñ‡∏≠‡∏ô‡∏ó‡∏≥‡∏£‡∏±‡∏á)</option>
        </select>
        <div class="hint">
          ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ß‡∏±‡∏¢‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ß‡∏±‡∏¢‡∏ô‡∏±‡πâ‡∏ô‡πÉ‡∏´‡πâ
        </div>
      </div>
    </div>

    <div class="actions">
      <button id="calcBtn">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô</button>
    </div>

    <div id="messageArea"></div>
    <div id="resultArea"></div>

    <hr>

    <div class="note">
      ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö 1 ‡πÅ‡∏ú‡πà‡∏ô‡πÑ‡∏Ç‡πà‡πÑ‡∏´‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ
      ‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏∏‡∏Å‡∏°‡∏∑‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°‡∏£‡πà‡∏ß‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡πà‡∏≤‡πÉ‡∏ö‡∏´‡∏°‡∏î‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Ñ‡πâ‡∏≤‡∏á‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏°‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ
    </div>

    <div class="footer">
      ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÑ‡∏´‡∏° ‚Äì ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏¢‡∏≤‡∏¢ ‡πÜ ‡∏õ‡πâ‡∏≤ ‡πÜ ‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏¢‡∏ï‡∏≤‡πÑ‡∏°‡πà‡∏î‡∏µ
    </div>
  </div>

  <script>
    // ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÑ‡∏´‡∏° (‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏ç‡πà + ‡∏¢‡πà‡∏≠‡∏¢)
    const silkwormBreeds = {
      group_native: {
        label: "‡πÑ‡∏´‡∏°‡πÑ‡∏ó‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô",
        totalLeafKgPerSheet: 200,
        perInstar: {
          1: 1.5,
          2: 4.0,
          3: 6.5,
          4: 28,
          5: 160
        },
        subBreeds: [
          { id: "samrong1", name: "‡∏™‡∏≥‡πÇ‡∏£‡∏á 1", note: "‡∏£‡∏±‡∏á‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á ‡∏´‡∏±‡∏ß‡∏õ‡πâ‡∏≤‡∏ô‡∏ó‡πâ‡∏≤‡∏¢‡πÅ‡∏´‡∏•‡∏°" },
          { id: "nangtui",  name: "‡∏ô‡∏≤‡∏á‡∏ï‡∏∏‡πà‡∏¢", note: "‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏á‡πà‡∏≤‡∏¢ ‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á" },
          { id: "sp1",      name: "‡∏ô‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£ (SP1)", note: "‡∏Ñ‡∏±‡∏î‡πÅ‡∏¢‡∏Å‡πÄ‡∏û‡∏®‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡∏ô‡∏≠‡∏ô" },
          { id: "nuetoon",  name: "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏™‡∏µ‡∏ï‡∏∏‡πà‡∏ô", note: "‡∏£‡∏±‡∏á‡∏™‡∏µ‡∏à‡∏≥‡∏õ‡∏≤" }
        ]
      },
      group_hybrid_thai: {
        label: "‡πÑ‡∏´‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏•‡∏π‡∏Å‡∏ú‡∏™‡∏° (‡πÑ‡∏ó‡∏¢)",
        totalLeafKgPerSheet: 300,
        perInstar: {
          1: 2.5,
          2: 6.0,
          3: 9.5,
          4: 42,
          5: 240
        },
        subBreeds: [
          { id: "kosk2",   name: "‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå ‡∏Å‡∏™‡∏Å.2", note: "‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡∏£‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 18‚Äì20 ‡∏Å‡∏Å./‡πÅ‡∏ú‡πà‡∏ô" },
          { id: "dokbua",  name: "‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏î‡∏≠‡∏Å‡∏ö‡∏±‡∏ß", note: "‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡∏£‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 16‚Äì18 ‡∏Å‡∏Å./‡πÅ‡∏ú‡πà‡∏ô" },
          { id: "sakol1",  name: "‡πÑ‡∏´‡∏°‡πÑ‡∏ó‡∏¢‡∏•‡∏π‡∏Å‡∏ú‡∏™‡∏°‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£ 1" },
          { id: "sakol2",  name: "‡πÑ‡∏´‡∏°‡πÑ‡∏ó‡∏¢‡∏•‡∏π‡∏Å‡∏ú‡∏™‡∏°‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£ 2" },
          { id: "ubon6035", name: "‡πÑ‡∏´‡∏°‡∏•‡∏π‡∏Å‡∏ú‡∏™‡∏°‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ 60-35" }
        ]
      },
      group_hybrid_foreign: {
        label: "‡πÑ‡∏´‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏•‡∏π‡∏Å‡∏ú‡∏™‡∏°‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®",
        // ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏•‡∏π‡∏Å‡∏ú‡∏™‡∏°‡πÑ‡∏ó‡∏¢
        totalLeafKgPerSheet: 300,
        perInstar: {
          1: 2.5,
          2: 6.0,
          3: 9.5,
          4: 42,
          5: 240
        },
        warning: "‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏•‡∏π‡∏Å‡∏ú‡∏™‡∏°‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÉ‡∏´‡πâ‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡∏£‡∏±‡∏á‡∏™‡∏π‡∏á (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 30 ‡∏Å‡∏Å./‡πÅ‡∏ú‡πà‡∏ô) ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡∏≠‡∏≤‡∏à‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏ô‡∏µ‡πâ ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏´‡∏°‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à",
        subBreeds: [
          { id: "japan",  name: "‡∏•‡∏π‡∏Å‡∏ú‡∏™‡∏°‡∏™‡∏≤‡∏¢‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô" },
          { id: "china",  name: "‡∏•‡∏π‡∏Å‡∏ú‡∏™‡∏°‡∏™‡∏≤‡∏¢‡∏à‡∏µ‡∏ô" },
          { id: "korea",  name: "‡∏•‡∏π‡∏Å‡∏ú‡∏™‡∏°‡∏™‡∏≤‡∏¢‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ" },
          { id: "taiwan", name: "‡∏•‡∏π‡∏Å‡∏ú‡∏™‡∏°‡∏™‡∏≤‡∏¢‡πÑ‡∏ï‡πâ‡∏´‡∏ß‡∏±‡∏ô" },
          { id: "jimthompson", name: "‡∏™‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô (‡πÄ‡∏ä‡πà‡∏ô Jim Thompson)" }
        ]
      }
    };

    // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÉ‡∏ö + ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ (‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≥‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ)
    const instarLeafInfo = {
      1: {
        quality: "‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏ö‡∏ó‡∏µ‡πà 1‚Äì2 ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏¢‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏µ‡πà‡πÅ‡∏ú‡πà‡∏ô‡πÉ‡∏ö‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏≤‡∏Å‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÉ‡∏ö‡∏ó‡∏µ‡πà 1‚Äì3",
        prep: "‡∏´‡∏±‡πà‡∏ô‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏à‡∏±‡∏ï‡∏∏‡∏£‡∏±‡∏™‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏°‡∏≤‡∏Å ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 0.5‚Äì1.0 ‡πÄ‡∏ã‡∏ô‡∏ï‡∏¥‡πÄ‡∏°‡∏ï‡∏£ ‡πÇ‡∏£‡∏¢‡∏ö‡∏≤‡∏á ‡πÜ ‡∏ß‡∏±‡∏ô‡∏•‡∏∞ 3‚Äì4 ‡∏°‡∏∑‡πâ‡∏≠ ‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏´‡πâ‡πÉ‡∏ö‡πÅ‡∏´‡πâ‡∏á‡∏Ñ‡∏≤‡∏Ñ‡∏≠‡∏Å"
      },
      2: {
        quality: "‡πÉ‡∏ä‡πâ‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡πÉ‡∏ö‡∏ó‡∏µ‡πà 4‚Äì6 ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏´‡∏°‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏• ‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏≠‡πà‡∏≠‡∏ô",
        prep: "‡∏´‡∏±‡πà‡∏ô‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô ‡∏Ç‡∏ô‡∏≤‡∏î‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 1.5‚Äì2.0 ‡πÄ‡∏ã‡∏ô‡∏ï‡∏¥‡πÄ‡∏°‡∏ï‡∏£ ‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏ó‡∏±‡πà‡∏ß‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏£‡∏≤‡∏ß 80% ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏µ‡∏¢‡∏Å‡πÅ‡∏â‡∏∞"
      },
      3: {
        quality: "‡πÉ‡∏ä‡πâ‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡πÉ‡∏ö‡∏ó‡∏µ‡πà 7‚Äì10 ‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏£‡∏≠‡∏¢‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏¥‡πà‡∏á‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏• ‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏¢ 3",
        prep: "‡∏´‡∏±‡πà‡∏ô‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô ‡∏Ç‡∏ô‡∏≤‡∏î‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 2.5‚Äì3.0 ‡πÄ‡∏ã‡∏ô‡∏ï‡∏¥‡πÄ‡∏°‡∏ï‡∏£ ‡∏ô‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏±‡πà‡∏ô‡πÉ‡∏ö‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢ ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏´‡πâ‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ö‡πÉ‡∏ô‡∏ß‡∏±‡∏¢‡∏ñ‡∏±‡∏î‡πÑ‡∏õ"
      },
      4: {
        quality: "‡πÉ‡∏ä‡πâ‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏à‡∏≤‡∏Å‡∏Å‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏• ‡πÉ‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå ‡πÑ‡∏°‡πà‡∏≠‡πà‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Å‡πà‡∏°‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ",
        prep: "‡∏´‡∏¢‡∏∏‡∏î‡∏´‡∏±‡πà‡∏ô‡πÉ‡∏ö ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏´‡πâ‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏Å‡∏¥‡πà‡∏á ‡∏ß‡∏≤‡∏á‡∏Å‡∏¥‡πà‡∏á‡πÉ‡∏´‡πâ‡πÇ‡∏õ‡∏£‡πà‡∏á ‡πÜ ‡πÑ‡∏°‡πà‡∏Å‡∏≠‡∏á‡∏ó‡∏±‡∏ö‡∏Å‡∏±‡∏ô‡∏´‡∏ô‡∏≤ ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 24‚Äì25¬∞C ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô 75‚Äì80%"
      },
      5: {
        quality: "‡πÉ‡∏ä‡πâ‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏≤‡∏Å‡∏Å‡∏¥‡πà‡∏á‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏• ‡πÉ‡∏ö‡∏™‡∏î ‡∏™‡∏∞‡∏≠‡∏≤‡∏î ‡πÑ‡∏°‡πà‡∏ä‡πâ‡∏≥ ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏µ‡∏¢‡∏Å‡∏ù‡∏ô",
        prep: "‡πÉ‡∏´‡πâ‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏Å‡∏¥‡πà‡∏á‡πÉ‡∏ô‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏°‡∏≤‡∏Å ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ä‡πà‡∏ß‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏Å‡∏¥‡∏ô‡∏î‡∏∏‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏´‡πâ‡πÉ‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Ñ‡πâ‡∏≤‡∏á‡∏à‡∏ô‡πÄ‡∏ô‡πà‡∏≤ ‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏°‡∏™‡∏∏‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏¢‡∏∏‡∏î‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ñ‡∏≠‡∏ô"
      }
    };

    const daysPerInstar = {
      1: 3,
      2: 3,
      3: 4,
      4: 5,
      5: 8
    };

    const breedGroupSelect = document.getElementById("breedGroup");
    const subBreedSelect = document.getElementById("subBreed");
    const sheetCountInput = document.getElementById("sheetCount");
    const instarSelect = document.getElementById("instar");
    const calcBtn = document.getElementById("calcBtn");
    const messageArea = document.getElementById("messageArea");
    const resultArea = document.getElementById("resultArea");

    let currentSpeechText = "";
    let isSpeaking = false;

    // ‡πÄ‡∏ï‡∏¥‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏¢‡πà‡∏≠‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå
    breedGroupSelect.addEventListener("change", () => {
      const groupKey = breedGroupSelect.value;
      subBreedSelect.innerHTML = "";
      subBreedSelect.disabled = true;

      const baseOption = document.createElement("option");
      baseOption.value = "";
      baseOption.textContent = "-- ‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏¢‡πà‡∏≠‡∏¢ --";
      subBreedSelect.appendChild(baseOption);

      if (!groupKey || !silkwormBreeds[groupKey]) {
        return;
      }

      const group = silkwormBreeds[groupKey];
      if (group.subBreeds && group.subBreeds.length > 0) {
        group.subBreeds.forEach(sb => {
          const opt = document.createElement("option");
          opt.value = sb.id;
          opt.textContent = sb.name;
          subBreedSelect.appendChild(opt);
        });
        subBreedSelect.disabled = false;
      }
    });

    function formatNumber(num, digits = 1) {
      return Number(num).toFixed(digits).replace(/\.0+$/, '');
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏¢‡∏ô‡∏±‡πâ‡∏ô ‡πÜ
    function buildResultData(groupKey, instar, sheets) {
      const group = silkwormBreeds[groupKey];
      const perInstarKg = group.perInstar[instar];
      const totalAllSheets = perInstarKg * sheets;
      const days = daysPerInstar[instar] || 1;
      const avgPerDay = totalAllSheets / days;

      let instarName = "";
      switch (Number(instar)) {
        case 1: instarName = "‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà 1 (‡∏ß‡∏±‡∏¢‡∏≠‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô)"; break;
        case 2: instarName = "‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà 2"; break;
        case 3: instarName = "‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà 3"; break;
        case 4: instarName = "‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà 4 (‡∏ß‡∏±‡∏¢‡πÅ‡∏Å‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏ô‡∏°‡∏≤‡∏Å)"; break;
        case 5: instarName = "‡∏ß‡∏±‡∏¢‡∏ó‡∏µ‡πà 5 (‡∏ß‡∏±‡∏¢‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ñ‡∏≠‡∏ô)"; break;
      }

      let instarAdvice = "";
      if (instar === "1" || instar === 1) {
        instarAdvice = "‡∏ä‡πà‡∏ß‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏¢‡∏≠‡πà‡∏≠‡∏ô‡∏°‡∏≤‡∏Å ‡πÉ‡∏´‡πâ‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡πÉ‡∏ö‡∏≠‡πà‡∏≠‡∏ô ‡∏´‡∏±‡πà‡∏ô‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡πÉ‡∏´‡πâ‡∏ö‡πà‡∏≠‡∏¢ 3‚Äì4 ‡∏°‡∏∑‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô ‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏´‡πâ‡πÉ‡∏ö‡πÅ‡∏´‡πâ‡∏á‡∏Ñ‡∏≤‡∏Ñ‡∏≠‡∏Å.";
      } else if (instar === "2" || instar === 2) {
        instarAdvice = "‡∏ß‡∏±‡∏¢ 2 ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á‡∏Ç‡∏∂‡πâ‡∏ô ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡πÉ‡∏ö‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ.";
      } else if (instar === "3" || instar === 3) {
        instarAdvice = "‡∏ß‡∏±‡∏¢ 3 ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏¢‡∏≠‡πà‡∏≠‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡πâ‡∏≤‡∏¢ ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡πÉ‡∏ö‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢ ‡πÜ ‡∏Ñ‡∏ß‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÉ‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ô‡πà‡∏≤.";
      } else if (instar === "4" || instar === 4) {
        instarAdvice = "‡∏ß‡∏±‡∏¢ 4 ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏ß‡∏±‡∏¢‡πÅ‡∏Å‡πà ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡πâ‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏Å‡∏¥‡πà‡∏á ‡∏õ‡∏£‡∏±‡∏ö‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÉ‡∏´‡πâ‡πÄ‡∏¢‡πá‡∏ô‡∏•‡∏á ‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏≠‡∏≤‡∏Å‡∏≤‡∏® ‡∏ñ‡πà‡∏≤‡∏¢‡∏°‡∏π‡∏•‡πÑ‡∏´‡∏°‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠.";
      } else if (instar === "5" || instar === 5) {
        instarAdvice = "‡∏ß‡∏±‡∏¢ 5 ‡∏Å‡∏¥‡∏ô‡∏´‡∏ô‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÉ‡∏ö‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ä‡πà‡∏ß‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏¢ ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≠‡∏¢‡∏î‡∏π‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏°‡∏™‡∏∏‡∏Å ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏¢‡∏∏‡∏î‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ñ‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤.";
      }

      const leafInfo = instarLeafInfo[instar] || {};

      return {
        groupLabel: group.label,
        instarName,
        totalAllSheets,
        days,
        avgPerDay,
        instarAdvice,
        leafQuality: leafInfo.quality || "",
        leafPrep: leafInfo.prep || ""
      };
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏û‡∏π‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
    function speakText(text, buttonEl) {
      if (!("speechSynthesis" in window)) {
        alert("‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥");
        return;
      }

      // ‡∏ñ‡πâ‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏π‡∏î‡∏≠‡∏¢‡∏π‡πà ‡πÉ‡∏´‡πâ‡∏´‡∏¢‡∏∏‡∏î
      if (isSpeaking) {
        window.speechSynthesis.cancel();
        isSpeaking = false;
        if (buttonEl) buttonEl.textContent = "‚ñ∂ ‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥";
        return;
      }

      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = "th-TH";
      utter.rate = 0.95;  // ‡∏ä‡πâ‡∏≤‡∏•‡∏á‡∏´‡∏ô‡πà‡∏≠‡∏¢ ‡∏ü‡∏±‡∏á‡∏á‡πà‡∏≤‡∏¢
      utter.onend = () => {
        isSpeaking = false;
        if (buttonEl) buttonEl.textContent = "‚ñ∂ ‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥";
      };

      isSpeaking = true;
      if (buttonEl) buttonEl.textContent = "‚ñ† ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á";
      window.speechSynthesis.cancel();
      window.speechSynthesis.speak(utter);
    }

    // ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
    calcBtn.addEventListener("click", () => {
      messageArea.innerHTML = "";
      resultArea.innerHTML = "";
      window.speechSynthesis.cancel();
      isSpeaking = false;

      const groupKey = breedGroupSelect.value;
      const instar = instarSelect.value;
      let sheets = sheetCountInput.value.trim();

      const messages = [];

      if (!groupKey) {
        messages.push("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡πà‡∏∞");
      }

      if (!instar) {
        messages.push("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏¢‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°‡πÉ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡πà‡∏∞");
      }

      if (!sheets) {
        sheets = "1";
      }

      const sheetsNum = Number(sheets);
      if (isNaN(sheetsNum) || sheetsNum <= 0) {
        messages.push("‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡πÑ‡∏Ç‡πà‡πÑ‡∏´‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0 ‡πÅ‡∏ú‡πà‡∏ô");
      }

      if (messages.length > 0) {
        const div = document.createElement("div");
        div.className = "message error";
        div.innerHTML = messages.map(m => "‚Ä¢ " + m).join("<br>");
        messageArea.appendChild(div);
        return;
      }

      const group = silkwormBreeds[groupKey];
      if (!group || !group.perInstar[instar]) {
        const div = document.createElement("div");
        div.className = "message error";
        div.textContent = "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏¢‡πÑ‡∏´‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å";
        messageArea.appendChild(div);
        return;
      }

      // ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏•‡∏π‡∏Å‡∏ú‡∏™‡∏°‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®
      if (groupKey === "group_hybrid_foreign" && group.warning) {
        const warnDiv = document.createElement("div");
        warnDiv.className = "message warning";
        warnDiv.textContent = group.warning;
        messageArea.appendChild(warnDiv);
      }

      const result = buildResultData(groupKey, instar, sheetsNum);

      // ‡∏ä‡πà‡∏ß‡∏á‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô‡πÅ‡∏ö‡∏ö‡∏ä‡πà‡∏ß‡∏á (¬±20%)
      const low = result.avgPerDay * 0.8;
      const high = result.avgPerDay * 1.2;
      const perDayRangeText =
        `${formatNumber(low, 1)}‚Äì${formatNumber(high, 1)} ‡∏Å‡∏Å./‡∏ß‡∏±‡∏ô (‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì)`;

      const sheetsText = sheetsNum === 1
        ? "1 ‡πÅ‡∏ú‡πà‡∏ô"
        : formatNumber(sheetsNum, 1) + " ‡πÅ‡∏ú‡πà‡∏ô";

      // ‡∏™‡∏£‡πâ‡∏≤‡∏á card ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
      const resultDiv = document.createElement("div");
      resultDiv.className = "result-card";

      resultDiv.innerHTML = `
        <div class="result-title">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô</div>
        <p>
          ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå: <span class="result-key">${result.groupLabel}</span><br>
          ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á: <span class="result-key">${sheetsText}</span><br>
          ‡∏ß‡∏±‡∏¢‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: <span class="result-key">${result.instarName}</span>
        </p>
        <p>
          ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏¢‡∏ô‡∏µ‡πâ ‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô <span class="result-highlight">${sheetsText}</span>
          ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡∏£‡∏ß‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì
          <span class="result-highlight">${formatNumber(result.totalAllSheets, 1)} ‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°</span>
          ‡∏ï‡∏•‡∏≠‡∏î‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏¢‡∏ô‡∏µ‡πâ (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ${result.days} ‡∏ß‡∏±‡∏ô)
        </p>
        <p>
          ‡∏ñ‡πâ‡∏≤‡πÅ‡∏ö‡πà‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô ‡∏à‡∏∞‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì
          <span class="result-highlight">${formatNumber(result.avgPerDay, 1)} ‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°/‡∏ß‡∏±‡∏ô</span><br>
          ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ß‡∏±‡∏ô‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì
          <span class="result-key">${perDayRangeText}</span>
          ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‚Äì‡∏•‡∏î‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á
        </p>
        <p>
          <span class="result-key">‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏ß‡∏±‡∏¢‡∏ô‡∏µ‡πâ:</span><br>
          ${result.leafQuality || "-"}
        </p>
        <p>
          <span class="result-key">‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô / ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏ö‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</span><br>
          ${result.leafPrep || "-"}
        </p>
        <p>
          ‡∏Ç‡πâ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏¢‡∏ô‡∏µ‡πâ:<br>
          <span class="result-key">${result.instarAdvice}</span>
        </p>
        <button type="button" class="speak-btn" id="speakBtn">‚ñ∂ ‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</button>
      `;

      resultArea.appendChild(resultDiv);

      // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á (‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢)
      currentSpeechText =
        `‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ${result.groupLabel} ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${sheetsText} ` +
        `‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà ${result.instarName} ` +
        `‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ö‡∏´‡∏°‡πà‡∏≠‡∏ô‡∏£‡∏ß‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ${formatNumber(result.totalAllSheets, 1)} ‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏° ` +
        `‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ß‡∏±‡∏ô‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ${formatNumber(result.avgPerDay, 1)} ‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô ` +
        `‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÉ‡∏ö‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ ‡∏Ñ‡∏∑‡∏≠ ${result.leafQuality} ` +
        `‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÉ‡∏ö‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ ‡∏Ñ‡∏∑‡∏≠ ${result.leafPrep} ` +
        `‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°: ${result.instarAdvice}`;

      const speakBtn = document.getElementById("speakBtn");
      speakBtn.addEventListener("click", () => {
        speakText(currentSpeechText, speakBtn);
      });

      // üîó ‡πÅ‡∏à‡πâ‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏≠‡∏õ (‡∏ñ‡πâ‡∏≤‡∏à‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏´‡∏ô‡∏≠‡∏ô‡πÑ‡∏´‡∏°)
      const eventDetail = {
        groupKey,
        groupLabel: result.groupLabel,
        instar: Number(instar),
        instarName: result.instarName,
        sheetCount: sheetsNum,
        totalLeafKg: result.totalAllSheets,
        avgLeafPerDayKg: result.avgPerDay,
        leafQuality: result.leafQuality,
        leafPrep: result.leafPrep
      };
      document.dispatchEvent(
        new CustomEvent("mulberryRecommendationCalculated", { detail: eventDetail })
      );
    });
  </script>
</body>
</html>
